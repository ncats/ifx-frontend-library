<div [formGroup]="form">
  @switch (question.controlType) {
    @case ('textbox') {
      <mat-form-field class="full-width" appearance="outline" color="accent">
        <mat-label [attr.for]="question.key">{{ question.label }}</mat-label>
        <input matInput [id]="question.key" [type]="question.type" />
      </mat-form-field>
    }
    @case ('number') {
      <mat-form-field class="full-width" appearance="outline" color="accent">
        <mat-label [attr.for]="question.key">{{ question.label }}</mat-label>
        <input
          matInput
          [formControlName]="question.key"
          [id]="question.key"
          [type]="question.type"
          [step]="question.step"
          [min]="question.min"
          [max]="question.max"
        />
      </mat-form-field>
    }
    @case ('textarea') {
      <mat-form-field class="full-width" appearance="outline" color="accent">
        <mat-label [attr.for]="question.key">{{ question.label }}</mat-label>
        <textarea
          matInput
          [formControlName]="question.key"
          [id]="question.key"
          rows="10"
          cdkTextareaAutosize
        ></textarea>
      </mat-form-field>
    }
    @case ('dropdown') {
      <mat-form-field class="full-width" appearance="outline" color="accent">
        <mat-label [attr.for]="question.key">{{ question.label }}</mat-label>
        <mat-select [id]="question.key" [formControlName]="question.key">
          @for (opt of question.options; track opt.key) {
            <mat-option [value]="opt.key">{{ opt.value }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
    }

    @case ('multiselect') {
      <mat-form-field class="full-width" appearance="outline" color="accent">
        <mat-label [attr.for]="question.key">{{ question.label }}</mat-label>
        <mat-select
          [id]="question.key"
          [formControlName]="question.key"
          multiple
        >
          @for (opt of question.options; track opt.key) {
            <mat-option [value]="opt.key">{{ opt.value }}</mat-option>
          }
        </mat-select>
      </mat-form-field>
    }

    @case ('radio') {
      <mat-label [attr.for]="question.key">{{ question.label }}</mat-label
      ><br />
      <mat-radio-group
        [formControlName]="question.key"
        [id]="question.key"
        [value]="question.value"
        [name]="question.key"
      >
        @for (opt of question.options; track opt.key) {
          <mat-radio-button [value]="opt.key" [color]="'accent'">{{
            opt.value
          }}</mat-radio-button>
          <br />
        }
      </mat-radio-group>
    }
    @case ('file') {
      <mat-label [attr.for]="question.key">{{ question.label }}</mat-label>
      <lib-shared-forms-file-upload
        [formControlName]="question.key"
      ></lib-shared-forms-file-upload>
    }
  }
  @if (question.description) {
    <div class="help-text">{{ question.description }}</div>
    <br />
  }
  @if (!isValid) {
    <div class="errorMessage">{{ question.label }} is required</div>
  }
</div>
